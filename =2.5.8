Collecting flash-attn
  Downloading flash_attn-2.8.3.tar.gz (8.4 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 8.4/8.4 MB 91.3 MB/s eta 0:00:00
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Requirement already satisfied: einops in ./venv/lib/python3.10/site-packages (from flash-attn) (0.8.1)
Requirement already satisfied: torch in ./venv/lib/python3.10/site-packages (from flash-attn) (2.3.0+cu121)
Requirement already satisfied: triton==2.3.0 in ./venv/lib/python3.10/site-packages (from torch->flash-attn) (2.3.0)
Requirement already satisfied: fsspec in ./venv/lib/python3.10/site-packages (from torch->flash-attn) (2025.12.0)
Requirement already satisfied: nvidia-cuda-cupti-cu12==12.1.105 in ./venv/lib/python3.10/site-packages (from torch->flash-attn) (12.1.105)
Requirement already satisfied: filelock in ./venv/lib/python3.10/site-packages (from torch->flash-attn) (3.20.0)
Requirement already satisfied: nvidia-curand-cu12==10.3.2.106 in ./venv/lib/python3.10/site-packages (from torch->flash-attn) (10.3.2.106)
Requirement already satisfied: typing-extensions>=4.8.0 in ./venv/lib/python3.10/site-packages (from torch->flash-attn) (4.15.0)
Requirement already satisfied: nvidia-cudnn-cu12==8.9.2.26 in ./venv/lib/python3.10/site-packages (from torch->flash-attn) (8.9.2.26)
Requirement already satisfied: nvidia-cusolver-cu12==11.4.5.107 in ./venv/lib/python3.10/site-packages (from torch->flash-attn) (11.4.5.107)
Requirement already satisfied: nvidia-cublas-cu12==12.1.3.1 in ./venv/lib/python3.10/site-packages (from torch->flash-attn) (12.1.3.1)
Requirement already satisfied: sympy in ./venv/lib/python3.10/site-packages (from torch->flash-attn) (1.14.0)
Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.1.105 in ./venv/lib/python3.10/site-packages (from torch->flash-attn) (12.1.105)
Requirement already satisfied: nvidia-cusparse-cu12==12.1.0.106 in ./venv/lib/python3.10/site-packages (from torch->flash-attn) (12.1.0.106)
Requirement already satisfied: nvidia-nvtx-cu12==12.1.105 in ./venv/lib/python3.10/site-packages (from torch->flash-attn) (12.1.105)
Requirement already satisfied: nvidia-cufft-cu12==11.0.2.54 in ./venv/lib/python3.10/site-packages (from torch->flash-attn) (11.0.2.54)
Requirement already satisfied: nvidia-cuda-runtime-cu12==12.1.105 in ./venv/lib/python3.10/site-packages (from torch->flash-attn) (12.1.105)
Requirement already satisfied: networkx in ./venv/lib/python3.10/site-packages (from torch->flash-attn) (3.4.2)
Requirement already satisfied: nvidia-nccl-cu12==2.20.5 in ./venv/lib/python3.10/site-packages (from torch->flash-attn) (2.20.5)
Requirement already satisfied: jinja2 in ./venv/lib/python3.10/site-packages (from torch->flash-attn) (3.1.6)
Requirement already satisfied: nvidia-nvjitlink-cu12 in ./venv/lib/python3.10/site-packages (from nvidia-cusolver-cu12==11.4.5.107->torch->flash-attn) (12.9.86)
Requirement already satisfied: MarkupSafe>=2.0 in ./venv/lib/python3.10/site-packages (from jinja2->torch->flash-attn) (2.1.5)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in ./venv/lib/python3.10/site-packages (from sympy->torch->flash-attn) (1.3.0)
Building wheels for collected packages: flash-attn
  Building wheel for flash-attn (setup.py): started
  Building wheel for flash-attn (setup.py): still running...
  Building wheel for flash-attn (setup.py): still running...
  Building wheel for flash-attn (setup.py): still running...
  Building wheel for flash-attn (setup.py): still running...
  Building wheel for flash-attn (setup.py): still running...
  Building wheel for flash-attn (setup.py): finished with status 'error'
  error: subprocess-exited-with-error
  
  × python setup.py bdist_wheel did not run successfully.
  │ exit code: 1
  ╰─> [234 lines of output]
      
      
      torch.__version__  = 2.3.0+cu121
      
      
      /lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/setuptools/installer.py:27: SetuptoolsDeprecationWarning: setuptools.installer is deprecated. Requirements should be satisfied by a PEP 517 installer.
        warnings.warn(
      running bdist_wheel
      Guessing wheel URL:  https://github.com/Dao-AILab/flash-attention/releases/download/v2.8.3/flash_attn-2.8.3+cu12torch2.3cxx11abiFALSE-cp310-cp310-linux_x86_64.whl
      Precompiled wheel not found. Building from source...
      running build
      running build_py
      creating build
      creating build/lib.linux-x86_64-3.10
      creating build/lib.linux-x86_64-3.10/flash_attn
      copying flash_attn/flash_blocksparse_attn_interface.py -> build/lib.linux-x86_64-3.10/flash_attn
      copying flash_attn/__init__.py -> build/lib.linux-x86_64-3.10/flash_attn
      copying flash_attn/flash_blocksparse_attention.py -> build/lib.linux-x86_64-3.10/flash_attn
      copying flash_attn/flash_attn_triton_og.py -> build/lib.linux-x86_64-3.10/flash_attn
      copying flash_attn/flash_attn_triton.py -> build/lib.linux-x86_64-3.10/flash_attn
      copying flash_attn/flash_attn_interface.py -> build/lib.linux-x86_64-3.10/flash_attn
      copying flash_attn/bert_padding.py -> build/lib.linux-x86_64-3.10/flash_attn
      creating build/lib.linux-x86_64-3.10/hopper
      copying hopper/benchmark_flash_attention_fp8.py -> build/lib.linux-x86_64-3.10/hopper
      copying hopper/test_flash_attn.py -> build/lib.linux-x86_64-3.10/hopper
      copying hopper/benchmark_attn.py -> build/lib.linux-x86_64-3.10/hopper
      copying hopper/benchmark_mla_decode.py -> build/lib.linux-x86_64-3.10/hopper
      copying hopper/test_kvcache.py -> build/lib.linux-x86_64-3.10/hopper
      copying hopper/__init__.py -> build/lib.linux-x86_64-3.10/hopper
      copying hopper/setup.py -> build/lib.linux-x86_64-3.10/hopper
      copying hopper/padding.py -> build/lib.linux-x86_64-3.10/hopper
      copying hopper/test_attn_kvcache.py -> build/lib.linux-x86_64-3.10/hopper
      copying hopper/test_util.py -> build/lib.linux-x86_64-3.10/hopper
      copying hopper/benchmark_split_kv.py -> build/lib.linux-x86_64-3.10/hopper
      copying hopper/generate_kernels.py -> build/lib.linux-x86_64-3.10/hopper
      copying hopper/flash_attn_interface.py -> build/lib.linux-x86_64-3.10/hopper
      creating build/lib.linux-x86_64-3.10/flash_attn/layers
      copying flash_attn/layers/__init__.py -> build/lib.linux-x86_64-3.10/flash_attn/layers
      copying flash_attn/layers/rotary.py -> build/lib.linux-x86_64-3.10/flash_attn/layers
      copying flash_attn/layers/patch_embed.py -> build/lib.linux-x86_64-3.10/flash_attn/layers
      creating build/lib.linux-x86_64-3.10/flash_attn/utils
      copying flash_attn/utils/distributed.py -> build/lib.linux-x86_64-3.10/flash_attn/utils
      copying flash_attn/utils/pretrained.py -> build/lib.linux-x86_64-3.10/flash_attn/utils
      copying flash_attn/utils/torch.py -> build/lib.linux-x86_64-3.10/flash_attn/utils
      copying flash_attn/utils/__init__.py -> build/lib.linux-x86_64-3.10/flash_attn/utils
      copying flash_attn/utils/library.py -> build/lib.linux-x86_64-3.10/flash_attn/utils
      copying flash_attn/utils/benchmark.py -> build/lib.linux-x86_64-3.10/flash_attn/utils
      copying flash_attn/utils/generation.py -> build/lib.linux-x86_64-3.10/flash_attn/utils
      copying flash_attn/utils/testing.py -> build/lib.linux-x86_64-3.10/flash_attn/utils
      creating build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/blackwell_helpers.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/fast_math.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/block_info.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/tile_scheduler.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/seqlen_info.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/interface.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/__init__.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/mask.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/flash_bwd_postprocess.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/flash_bwd_preprocess.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/mma_sm100_desc.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/flash_fwd.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/flash_fwd_sm100.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/pack_gqa.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/utils.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/hopper_helpers.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/pipeline.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/softmax.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/flash_bwd.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/ampere_helpers.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/named_barrier.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      creating build/lib.linux-x86_64-3.10/flash_attn/ops
      copying flash_attn/ops/activations.py -> build/lib.linux-x86_64-3.10/flash_attn/ops
      copying flash_attn/ops/__init__.py -> build/lib.linux-x86_64-3.10/flash_attn/ops
      copying flash_attn/ops/fused_dense.py -> build/lib.linux-x86_64-3.10/flash_attn/ops
      copying flash_attn/ops/layer_norm.py -> build/lib.linux-x86_64-3.10/flash_attn/ops
      copying flash_attn/ops/rms_norm.py -> build/lib.linux-x86_64-3.10/flash_attn/ops
      creating build/lib.linux-x86_64-3.10/flash_attn/flash_attn_triton_amd
      copying flash_attn/flash_attn_triton_amd/bwd_prefill_fused.py -> build/lib.linux-x86_64-3.10/flash_attn/flash_attn_triton_amd
      copying flash_attn/flash_attn_triton_amd/fp8.py -> build/lib.linux-x86_64-3.10/flash_attn/flash_attn_triton_amd
      copying flash_attn/flash_attn_triton_amd/bwd_ref.py -> build/lib.linux-x86_64-3.10/flash_attn/flash_attn_triton_amd
      copying flash_attn/flash_attn_triton_amd/__init__.py -> build/lib.linux-x86_64-3.10/flash_attn/flash_attn_triton_amd
      copying flash_attn/flash_attn_triton_amd/bwd_prefill.py -> build/lib.linux-x86_64-3.10/flash_attn/flash_attn_triton_amd
      copying flash_attn/flash_attn_triton_amd/test.py -> build/lib.linux-x86_64-3.10/flash_attn/flash_attn_triton_amd
      copying flash_attn/flash_attn_triton_amd/interface_fa.py -> build/lib.linux-x86_64-3.10/flash_attn/flash_attn_triton_amd
      copying flash_attn/flash_attn_triton_amd/fwd_prefill.py -> build/lib.linux-x86_64-3.10/flash_attn/flash_attn_triton_amd
      copying flash_attn/flash_attn_triton_amd/bwd_prefill_split.py -> build/lib.linux-x86_64-3.10/flash_attn/flash_attn_triton_amd
      copying flash_attn/flash_attn_triton_amd/bench.py -> build/lib.linux-x86_64-3.10/flash_attn/flash_attn_triton_amd
      copying flash_attn/flash_attn_triton_amd/train.py -> build/lib.linux-x86_64-3.10/flash_attn/flash_attn_triton_amd
      copying flash_attn/flash_attn_triton_amd/fwd_ref.py -> build/lib.linux-x86_64-3.10/flash_attn/flash_attn_triton_amd
      copying flash_attn/flash_attn_triton_amd/utils.py -> build/lib.linux-x86_64-3.10/flash_attn/flash_attn_triton_amd
      copying flash_attn/flash_attn_triton_amd/fwd_decode.py -> build/lib.linux-x86_64-3.10/flash_attn/flash_attn_triton_amd
      copying flash_attn/flash_attn_triton_amd/bwd_prefill_onekernel.py -> build/lib.linux-x86_64-3.10/flash_attn/flash_attn_triton_amd
      creating build/lib.linux-x86_64-3.10/flash_attn/models
      copying flash_attn/models/gpt.py -> build/lib.linux-x86_64-3.10/flash_attn/models
      copying flash_attn/models/__init__.py -> build/lib.linux-x86_64-3.10/flash_attn/models
      copying flash_attn/models/opt.py -> build/lib.linux-x86_64-3.10/flash_attn/models
      copying flash_attn/models/gpt_neox.py -> build/lib.linux-x86_64-3.10/flash_attn/models
      copying flash_attn/models/falcon.py -> build/lib.linux-x86_64-3.10/flash_attn/models
      copying flash_attn/models/vit.py -> build/lib.linux-x86_64-3.10/flash_attn/models
      copying flash_attn/models/btlm.py -> build/lib.linux-x86_64-3.10/flash_attn/models
      copying flash_attn/models/baichuan.py -> build/lib.linux-x86_64-3.10/flash_attn/models
      copying flash_attn/models/gptj.py -> build/lib.linux-x86_64-3.10/flash_attn/models
      copying flash_attn/models/llama.py -> build/lib.linux-x86_64-3.10/flash_attn/models
      copying flash_attn/models/bigcode.py -> build/lib.linux-x86_64-3.10/flash_attn/models
      copying flash_attn/models/bert.py -> build/lib.linux-x86_64-3.10/flash_attn/models
      creating build/lib.linux-x86_64-3.10/flash_attn/losses
      copying flash_attn/losses/__init__.py -> build/lib.linux-x86_64-3.10/flash_attn/losses
      copying flash_attn/losses/cross_entropy.py -> build/lib.linux-x86_64-3.10/flash_attn/losses
      creating build/lib.linux-x86_64-3.10/flash_attn/modules
      copying flash_attn/modules/mlp.py -> build/lib.linux-x86_64-3.10/flash_attn/modules
      copying flash_attn/modules/embedding.py -> build/lib.linux-x86_64-3.10/flash_attn/modules
      copying flash_attn/modules/__init__.py -> build/lib.linux-x86_64-3.10/flash_attn/modules
      copying flash_attn/modules/mha.py -> build/lib.linux-x86_64-3.10/flash_attn/modules
      copying flash_attn/modules/block.py -> build/lib.linux-x86_64-3.10/flash_attn/modules
      creating build/lib.linux-x86_64-3.10/flash_attn/ops/triton
      copying flash_attn/ops/triton/mlp.py -> build/lib.linux-x86_64-3.10/flash_attn/ops/triton
      copying flash_attn/ops/triton/__init__.py -> build/lib.linux-x86_64-3.10/flash_attn/ops/triton
      copying flash_attn/ops/triton/k_activations.py -> build/lib.linux-x86_64-3.10/flash_attn/ops/triton
      copying flash_attn/ops/triton/cross_entropy.py -> build/lib.linux-x86_64-3.10/flash_attn/ops/triton
      copying flash_attn/ops/triton/layer_norm.py -> build/lib.linux-x86_64-3.10/flash_attn/ops/triton
      copying flash_attn/ops/triton/rotary.py -> build/lib.linux-x86_64-3.10/flash_attn/ops/triton
      copying flash_attn/ops/triton/linear.py -> build/lib.linux-x86_64-3.10/flash_attn/ops/triton
      running build_ext
      /lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/utils/cpp_extension.py:418: UserWarning: The detected CUDA version (12.8) has a minor version mismatch with the version that was used to compile PyTorch (12.1). Most likely this shouldn't be a problem.
        warnings.warn(CUDA_MISMATCH_WARN.format(cuda_str_version, torch.version.cuda))
      /lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/utils/cpp_extension.py:428: UserWarning: There are no x86_64-linux-gnu-g++ version bounds defined for CUDA version 12.8
        warnings.warn(f'There are no {compiler_name} version bounds defined for CUDA version {cuda_str_version}')
      building 'flash_attn_2_cuda' extension
      creating /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10
      creating /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc
      creating /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn
      creating /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src
      Emitting ninja build file /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/build.ninja...
      Compiling objects...
      Using envvar MAX_JOBS (13) as the number of workers...
      [1/73] c++ -MMD -MF /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/flash_api.o.d -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O2 -Wall -g -fstack-protector-strong -Wformat -Werror=format-security -g -fwrapv -O2 -g -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -fPIC -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/flash_api.cpp -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/flash_api.o -O3 -std=c++17 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [2/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim192_fp16_causal_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim192_fp16_causal_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim192_fp16_causal_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [3/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim192_bf16_causal_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim192_bf16_causal_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim192_bf16_causal_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [4/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim256_fp16_causal_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim256_fp16_causal_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim256_fp16_causal_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      FAILED: [code=255] /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim256_fp16_causal_sm80.o
      /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim256_fp16_causal_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim256_fp16_causal_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim256_fp16_causal_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      Killed
      [5/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim32_bf16_causal_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim32_bf16_causal_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim32_bf16_causal_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [6/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim128_bf16_causal_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim128_bf16_causal_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim128_bf16_causal_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [7/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim128_fp16_causal_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim128_fp16_causal_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim128_fp16_causal_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [8/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim256_bf16_causal_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim256_bf16_causal_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim256_bf16_causal_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [9/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim192_bf16_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim192_bf16_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim192_bf16_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [10/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim192_fp16_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim192_fp16_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim192_fp16_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [11/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim128_fp16_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim128_fp16_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim128_fp16_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [12/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim128_bf16_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim128_bf16_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim128_bf16_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [13/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim32_fp16_causal_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim32_fp16_causal_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim32_fp16_causal_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [14/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim256_fp16_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim256_fp16_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim256_fp16_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [15/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim256_bf16_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim256_bf16_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim256_bf16_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [16/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim32_bf16_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim32_bf16_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim32_bf16_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      ninja: build stopped: subcommand failed.
      Traceback (most recent call last):
        File "/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/setup.py", line 486, in run
          urllib.request.urlretrieve(wheel_url, wheel_filename)
        File "/usr/lib/python3.10/urllib/request.py", line 241, in urlretrieve
          with contextlib.closing(urlopen(url, data)) as fp:
        File "/usr/lib/python3.10/urllib/request.py", line 216, in urlopen
          return opener.open(url, data, timeout)
        File "/usr/lib/python3.10/urllib/request.py", line 525, in open
          response = meth(req, response)
        File "/usr/lib/python3.10/urllib/request.py", line 634, in http_response
          response = self.parent.error(
        File "/usr/lib/python3.10/urllib/request.py", line 563, in error
          return self._call_chain(*args)
        File "/usr/lib/python3.10/urllib/request.py", line 496, in _call_chain
          result = func(*args)
        File "/usr/lib/python3.10/urllib/request.py", line 643, in http_error_default
          raise HTTPError(req.full_url, code, msg, hdrs, fp)
      urllib.error.HTTPError: HTTP Error 404: Not Found
      
      During handling of the above exception, another exception occurred:
      
      Traceback (most recent call last):
        File "/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/utils/cpp_extension.py", line 2107, in _run_ninja_build
          subprocess.run(
        File "/usr/lib/python3.10/subprocess.py", line 526, in run
          raise CalledProcessError(retcode, process.args,
      subprocess.CalledProcessError: Command '['ninja', '-v', '-j', '13']' returned non-zero exit status 255.
      
      The above exception was the direct cause of the following exception:
      
      Traceback (most recent call last):
        File "<string>", line 2, in <module>
        File "<pip-setuptools-caller>", line 34, in <module>
        File "/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/setup.py", line 526, in <module>
          setup(
        File "/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/setuptools/__init__.py", line 153, in setup
          return distutils.core.setup(**attrs)
        File "/usr/lib/python3.10/distutils/core.py", line 148, in setup
          dist.run_commands()
        File "/usr/lib/python3.10/distutils/dist.py", line 966, in run_commands
          self.run_command(cmd)
        File "/usr/lib/python3.10/distutils/dist.py", line 985, in run_command
          cmd_obj.run()
        File "/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/setup.py", line 503, in run
          super().run()
        File "/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/wheel/_bdist_wheel.py", line 387, in run
          self.run_command("build")
        File "/usr/lib/python3.10/distutils/cmd.py", line 313, in run_command
          self.distribution.run_command(command)
        File "/usr/lib/python3.10/distutils/dist.py", line 985, in run_command
          cmd_obj.run()
        File "/usr/lib/python3.10/distutils/command/build.py", line 135, in run
          self.run_command(cmd_name)
        File "/usr/lib/python3.10/distutils/cmd.py", line 313, in run_command
          self.distribution.run_command(command)
        File "/usr/lib/python3.10/distutils/dist.py", line 985, in run_command
          cmd_obj.run()
        File "/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/setuptools/command/build_ext.py", line 79, in run
          _build_ext.run(self)
        File "/usr/lib/python3.10/distutils/command/build_ext.py", line 340, in run
          self.build_extensions()
        File "/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/utils/cpp_extension.py", line 870, in build_extensions
          build_ext.build_extensions(self)
        File "/usr/lib/python3.10/distutils/command/build_ext.py", line 449, in build_extensions
          self._build_extensions_serial()
        File "/usr/lib/python3.10/distutils/command/build_ext.py", line 474, in _build_extensions_serial
          self.build_extension(ext)
        File "/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/setuptools/command/build_ext.py", line 202, in build_extension
          _build_ext.build_extension(self, ext)
        File "/usr/lib/python3.10/distutils/command/build_ext.py", line 529, in build_extension
          objects = self.compiler.compile(sources,
        File "/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/utils/cpp_extension.py", line 683, in unix_wrap_ninja_compile
          _write_ninja_file_and_compile_objects(
        File "/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/utils/cpp_extension.py", line 1783, in _write_ninja_file_and_compile_objects
          _run_ninja_build(
        File "/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/utils/cpp_extension.py", line 2123, in _run_ninja_build
          raise RuntimeError(message) from e
      RuntimeError: Error compiling objects for extension
      [end of output]
  
  note: This error originates from a subprocess, and is likely not a problem with pip.
  ERROR: Failed building wheel for flash-attn
  Running setup.py clean for flash-attn
Failed to build flash-attn
Installing collected packages: flash-attn
  Running setup.py install for flash-attn: started
  Running setup.py install for flash-attn: still running...
  Running setup.py install for flash-attn: still running...
  Running setup.py install for flash-attn: still running...
  Running setup.py install for flash-attn: still running...
  Running setup.py install for flash-attn: still running...
  Running setup.py install for flash-attn: still running...
  Running setup.py install for flash-attn: still running...
  Running setup.py install for flash-attn: still running...
  Running setup.py install for flash-attn: finished with status 'error'
  error: subprocess-exited-with-error
  
  × Running setup.py install for flash-attn did not run successfully.
  │ exit code: 1
  ╰─> [224 lines of output]
      
      
      torch.__version__  = 2.3.0+cu121
      
      
      /lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/setuptools/installer.py:27: SetuptoolsDeprecationWarning: setuptools.installer is deprecated. Requirements should be satisfied by a PEP 517 installer.
        warnings.warn(
      running install
      /lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/setuptools/command/install.py:34: SetuptoolsDeprecationWarning: setup.py install is deprecated. Use build and pip and other standards-based tools.
        warnings.warn(
      running build
      running build_py
      creating build
      creating build/lib.linux-x86_64-3.10
      creating build/lib.linux-x86_64-3.10/flash_attn
      copying flash_attn/flash_blocksparse_attn_interface.py -> build/lib.linux-x86_64-3.10/flash_attn
      copying flash_attn/__init__.py -> build/lib.linux-x86_64-3.10/flash_attn
      copying flash_attn/flash_blocksparse_attention.py -> build/lib.linux-x86_64-3.10/flash_attn
      copying flash_attn/flash_attn_triton_og.py -> build/lib.linux-x86_64-3.10/flash_attn
      copying flash_attn/flash_attn_triton.py -> build/lib.linux-x86_64-3.10/flash_attn
      copying flash_attn/flash_attn_interface.py -> build/lib.linux-x86_64-3.10/flash_attn
      copying flash_attn/bert_padding.py -> build/lib.linux-x86_64-3.10/flash_attn
      creating build/lib.linux-x86_64-3.10/hopper
      copying hopper/benchmark_flash_attention_fp8.py -> build/lib.linux-x86_64-3.10/hopper
      copying hopper/test_flash_attn.py -> build/lib.linux-x86_64-3.10/hopper
      copying hopper/benchmark_attn.py -> build/lib.linux-x86_64-3.10/hopper
      copying hopper/benchmark_mla_decode.py -> build/lib.linux-x86_64-3.10/hopper
      copying hopper/test_kvcache.py -> build/lib.linux-x86_64-3.10/hopper
      copying hopper/__init__.py -> build/lib.linux-x86_64-3.10/hopper
      copying hopper/setup.py -> build/lib.linux-x86_64-3.10/hopper
      copying hopper/padding.py -> build/lib.linux-x86_64-3.10/hopper
      copying hopper/test_attn_kvcache.py -> build/lib.linux-x86_64-3.10/hopper
      copying hopper/test_util.py -> build/lib.linux-x86_64-3.10/hopper
      copying hopper/benchmark_split_kv.py -> build/lib.linux-x86_64-3.10/hopper
      copying hopper/generate_kernels.py -> build/lib.linux-x86_64-3.10/hopper
      copying hopper/flash_attn_interface.py -> build/lib.linux-x86_64-3.10/hopper
      creating build/lib.linux-x86_64-3.10/flash_attn/layers
      copying flash_attn/layers/__init__.py -> build/lib.linux-x86_64-3.10/flash_attn/layers
      copying flash_attn/layers/rotary.py -> build/lib.linux-x86_64-3.10/flash_attn/layers
      copying flash_attn/layers/patch_embed.py -> build/lib.linux-x86_64-3.10/flash_attn/layers
      creating build/lib.linux-x86_64-3.10/flash_attn/utils
      copying flash_attn/utils/distributed.py -> build/lib.linux-x86_64-3.10/flash_attn/utils
      copying flash_attn/utils/pretrained.py -> build/lib.linux-x86_64-3.10/flash_attn/utils
      copying flash_attn/utils/torch.py -> build/lib.linux-x86_64-3.10/flash_attn/utils
      copying flash_attn/utils/__init__.py -> build/lib.linux-x86_64-3.10/flash_attn/utils
      copying flash_attn/utils/library.py -> build/lib.linux-x86_64-3.10/flash_attn/utils
      copying flash_attn/utils/benchmark.py -> build/lib.linux-x86_64-3.10/flash_attn/utils
      copying flash_attn/utils/generation.py -> build/lib.linux-x86_64-3.10/flash_attn/utils
      copying flash_attn/utils/testing.py -> build/lib.linux-x86_64-3.10/flash_attn/utils
      creating build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/blackwell_helpers.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/fast_math.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/block_info.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/tile_scheduler.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/seqlen_info.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/interface.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/__init__.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/mask.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/flash_bwd_postprocess.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/flash_bwd_preprocess.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/mma_sm100_desc.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/flash_fwd.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/flash_fwd_sm100.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/pack_gqa.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/utils.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/hopper_helpers.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/pipeline.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/softmax.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/flash_bwd.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/ampere_helpers.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      copying flash_attn/cute/named_barrier.py -> build/lib.linux-x86_64-3.10/flash_attn/cute
      creating build/lib.linux-x86_64-3.10/flash_attn/ops
      copying flash_attn/ops/activations.py -> build/lib.linux-x86_64-3.10/flash_attn/ops
      copying flash_attn/ops/__init__.py -> build/lib.linux-x86_64-3.10/flash_attn/ops
      copying flash_attn/ops/fused_dense.py -> build/lib.linux-x86_64-3.10/flash_attn/ops
      copying flash_attn/ops/layer_norm.py -> build/lib.linux-x86_64-3.10/flash_attn/ops
      copying flash_attn/ops/rms_norm.py -> build/lib.linux-x86_64-3.10/flash_attn/ops
      creating build/lib.linux-x86_64-3.10/flash_attn/flash_attn_triton_amd
      copying flash_attn/flash_attn_triton_amd/bwd_prefill_fused.py -> build/lib.linux-x86_64-3.10/flash_attn/flash_attn_triton_amd
      copying flash_attn/flash_attn_triton_amd/fp8.py -> build/lib.linux-x86_64-3.10/flash_attn/flash_attn_triton_amd
      copying flash_attn/flash_attn_triton_amd/bwd_ref.py -> build/lib.linux-x86_64-3.10/flash_attn/flash_attn_triton_amd
      copying flash_attn/flash_attn_triton_amd/__init__.py -> build/lib.linux-x86_64-3.10/flash_attn/flash_attn_triton_amd
      copying flash_attn/flash_attn_triton_amd/bwd_prefill.py -> build/lib.linux-x86_64-3.10/flash_attn/flash_attn_triton_amd
      copying flash_attn/flash_attn_triton_amd/test.py -> build/lib.linux-x86_64-3.10/flash_attn/flash_attn_triton_amd
      copying flash_attn/flash_attn_triton_amd/interface_fa.py -> build/lib.linux-x86_64-3.10/flash_attn/flash_attn_triton_amd
      copying flash_attn/flash_attn_triton_amd/fwd_prefill.py -> build/lib.linux-x86_64-3.10/flash_attn/flash_attn_triton_amd
      copying flash_attn/flash_attn_triton_amd/bwd_prefill_split.py -> build/lib.linux-x86_64-3.10/flash_attn/flash_attn_triton_amd
      copying flash_attn/flash_attn_triton_amd/bench.py -> build/lib.linux-x86_64-3.10/flash_attn/flash_attn_triton_amd
      copying flash_attn/flash_attn_triton_amd/train.py -> build/lib.linux-x86_64-3.10/flash_attn/flash_attn_triton_amd
      copying flash_attn/flash_attn_triton_amd/fwd_ref.py -> build/lib.linux-x86_64-3.10/flash_attn/flash_attn_triton_amd
      copying flash_attn/flash_attn_triton_amd/utils.py -> build/lib.linux-x86_64-3.10/flash_attn/flash_attn_triton_amd
      copying flash_attn/flash_attn_triton_amd/fwd_decode.py -> build/lib.linux-x86_64-3.10/flash_attn/flash_attn_triton_amd
      copying flash_attn/flash_attn_triton_amd/bwd_prefill_onekernel.py -> build/lib.linux-x86_64-3.10/flash_attn/flash_attn_triton_amd
      creating build/lib.linux-x86_64-3.10/flash_attn/models
      copying flash_attn/models/gpt.py -> build/lib.linux-x86_64-3.10/flash_attn/models
      copying flash_attn/models/__init__.py -> build/lib.linux-x86_64-3.10/flash_attn/models
      copying flash_attn/models/opt.py -> build/lib.linux-x86_64-3.10/flash_attn/models
      copying flash_attn/models/gpt_neox.py -> build/lib.linux-x86_64-3.10/flash_attn/models
      copying flash_attn/models/falcon.py -> build/lib.linux-x86_64-3.10/flash_attn/models
      copying flash_attn/models/vit.py -> build/lib.linux-x86_64-3.10/flash_attn/models
      copying flash_attn/models/btlm.py -> build/lib.linux-x86_64-3.10/flash_attn/models
      copying flash_attn/models/baichuan.py -> build/lib.linux-x86_64-3.10/flash_attn/models
      copying flash_attn/models/gptj.py -> build/lib.linux-x86_64-3.10/flash_attn/models
      copying flash_attn/models/llama.py -> build/lib.linux-x86_64-3.10/flash_attn/models
      copying flash_attn/models/bigcode.py -> build/lib.linux-x86_64-3.10/flash_attn/models
      copying flash_attn/models/bert.py -> build/lib.linux-x86_64-3.10/flash_attn/models
      creating build/lib.linux-x86_64-3.10/flash_attn/losses
      copying flash_attn/losses/__init__.py -> build/lib.linux-x86_64-3.10/flash_attn/losses
      copying flash_attn/losses/cross_entropy.py -> build/lib.linux-x86_64-3.10/flash_attn/losses
      creating build/lib.linux-x86_64-3.10/flash_attn/modules
      copying flash_attn/modules/mlp.py -> build/lib.linux-x86_64-3.10/flash_attn/modules
      copying flash_attn/modules/embedding.py -> build/lib.linux-x86_64-3.10/flash_attn/modules
      copying flash_attn/modules/__init__.py -> build/lib.linux-x86_64-3.10/flash_attn/modules
      copying flash_attn/modules/mha.py -> build/lib.linux-x86_64-3.10/flash_attn/modules
      copying flash_attn/modules/block.py -> build/lib.linux-x86_64-3.10/flash_attn/modules
      creating build/lib.linux-x86_64-3.10/flash_attn/ops/triton
      copying flash_attn/ops/triton/mlp.py -> build/lib.linux-x86_64-3.10/flash_attn/ops/triton
      copying flash_attn/ops/triton/__init__.py -> build/lib.linux-x86_64-3.10/flash_attn/ops/triton
      copying flash_attn/ops/triton/k_activations.py -> build/lib.linux-x86_64-3.10/flash_attn/ops/triton
      copying flash_attn/ops/triton/cross_entropy.py -> build/lib.linux-x86_64-3.10/flash_attn/ops/triton
      copying flash_attn/ops/triton/layer_norm.py -> build/lib.linux-x86_64-3.10/flash_attn/ops/triton
      copying flash_attn/ops/triton/rotary.py -> build/lib.linux-x86_64-3.10/flash_attn/ops/triton
      copying flash_attn/ops/triton/linear.py -> build/lib.linux-x86_64-3.10/flash_attn/ops/triton
      running build_ext
      /lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/utils/cpp_extension.py:418: UserWarning: The detected CUDA version (12.8) has a minor version mismatch with the version that was used to compile PyTorch (12.1). Most likely this shouldn't be a problem.
        warnings.warn(CUDA_MISMATCH_WARN.format(cuda_str_version, torch.version.cuda))
      /lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/utils/cpp_extension.py:428: UserWarning: There are no x86_64-linux-gnu-g++ version bounds defined for CUDA version 12.8
        warnings.warn(f'There are no {compiler_name} version bounds defined for CUDA version {cuda_str_version}')
      building 'flash_attn_2_cuda' extension
      creating /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10
      creating /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc
      creating /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn
      creating /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src
      Emitting ninja build file /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/build.ninja...
      Compiling objects...
      Using envvar MAX_JOBS (13) as the number of workers...
      [1/73] c++ -MMD -MF /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/flash_api.o.d -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O2 -Wall -g -fstack-protector-strong -Wformat -Werror=format-security -g -fwrapv -O2 -g -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -fPIC -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/flash_api.cpp -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/flash_api.o -O3 -std=c++17 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [2/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim192_fp16_causal_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim192_fp16_causal_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim192_fp16_causal_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [3/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim192_bf16_causal_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim192_bf16_causal_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim192_bf16_causal_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [4/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim128_fp16_causal_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim128_fp16_causal_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim128_fp16_causal_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [5/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim32_bf16_causal_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim32_bf16_causal_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim32_bf16_causal_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [6/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim256_fp16_causal_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim256_fp16_causal_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim256_fp16_causal_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [7/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim128_bf16_causal_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim128_bf16_causal_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim128_bf16_causal_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [8/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim256_bf16_causal_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim256_bf16_causal_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim256_bf16_causal_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [9/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim192_bf16_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim192_bf16_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim192_bf16_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [10/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim192_fp16_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim192_fp16_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim192_fp16_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [11/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim128_bf16_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim128_bf16_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim128_bf16_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [12/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim128_fp16_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim128_fp16_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim128_fp16_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [13/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim32_fp16_causal_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim32_fp16_causal_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim32_fp16_causal_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [14/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim256_fp16_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim256_fp16_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim256_fp16_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      FAILED: [code=255] /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim256_fp16_sm80.o
      /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim256_fp16_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim256_fp16_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim256_fp16_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      Killed
      Killed
      [15/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim256_bf16_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim256_bf16_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim256_bf16_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [16/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim32_bf16_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim32_bf16_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim32_bf16_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [17/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim64_fp16_causal_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim64_fp16_causal_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim64_fp16_causal_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [18/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim64_bf16_causal_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim64_bf16_causal_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim64_bf16_causal_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [19/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim32_fp16_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim32_fp16_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim32_fp16_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [20/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim96_bf16_causal_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim96_bf16_causal_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim96_bf16_causal_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [21/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim96_fp16_causal_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim96_fp16_causal_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim96_fp16_causal_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [22/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim64_bf16_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim64_bf16_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim64_bf16_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [23/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_fwd_hdim128_bf16_causal_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_fwd_hdim128_bf16_causal_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_fwd_hdim128_bf16_causal_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [24/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim64_fp16_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim64_fp16_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim64_fp16_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [25/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim96_bf16_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim96_bf16_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim96_bf16_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      [26/73] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim96_fp16_sm80.o.d -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src -I/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/cutlass/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/TH -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/include/THC -I/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/include -I/usr/include/python3.10 -c -c /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/csrc/flash_attn/src/flash_bwd_hdim96_fp16_sm80.cu -o /tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/build/temp.linux-x86_64-3.10/csrc/flash_attn/src/flash_bwd_hdim96_fp16_sm80.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O3 -std=c++17 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -U__CUDA_NO_BFLOAT16_CONVERSIONS__ --expt-relaxed-constexpr --expt-extended-lambda --use_fast_math -gencode arch=compute_80,code=sm_80 -gencode arch=compute_90,code=sm_90 -gencode arch=compute_100,code=sm_100 -gencode arch=compute_120,code=sm_120 --threads 4 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=flash_attn_2_cuda -D_GLIBCXX_USE_CXX11_ABI=0
      ninja: build stopped: subcommand failed.
      Traceback (most recent call last):
        File "/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/utils/cpp_extension.py", line 2107, in _run_ninja_build
          subprocess.run(
        File "/usr/lib/python3.10/subprocess.py", line 526, in run
          raise CalledProcessError(retcode, process.args,
      subprocess.CalledProcessError: Command '['ninja', '-v', '-j', '13']' returned non-zero exit status 255.
      
      The above exception was the direct cause of the following exception:
      
      Traceback (most recent call last):
        File "<string>", line 2, in <module>
        File "<pip-setuptools-caller>", line 34, in <module>
        File "/tmp/pip-install-9ltd77by/flash-attn_cd4e85487922430ab5119790c819558e/setup.py", line 526, in <module>
          setup(
        File "/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/setuptools/__init__.py", line 153, in setup
          return distutils.core.setup(**attrs)
        File "/usr/lib/python3.10/distutils/core.py", line 148, in setup
          dist.run_commands()
        File "/usr/lib/python3.10/distutils/dist.py", line 966, in run_commands
          self.run_command(cmd)
        File "/usr/lib/python3.10/distutils/dist.py", line 985, in run_command
          cmd_obj.run()
        File "/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/setuptools/command/install.py", line 68, in run
          return orig.install.run(self)
        File "/usr/lib/python3.10/distutils/command/install.py", line 619, in run
          self.run_command('build')
        File "/usr/lib/python3.10/distutils/cmd.py", line 313, in run_command
          self.distribution.run_command(command)
        File "/usr/lib/python3.10/distutils/dist.py", line 985, in run_command
          cmd_obj.run()
        File "/usr/lib/python3.10/distutils/command/build.py", line 135, in run
          self.run_command(cmd_name)
        File "/usr/lib/python3.10/distutils/cmd.py", line 313, in run_command
          self.distribution.run_command(command)
        File "/usr/lib/python3.10/distutils/dist.py", line 985, in run_command
          cmd_obj.run()
        File "/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/setuptools/command/build_ext.py", line 79, in run
          _build_ext.run(self)
        File "/usr/lib/python3.10/distutils/command/build_ext.py", line 340, in run
          self.build_extensions()
        File "/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/utils/cpp_extension.py", line 870, in build_extensions
          build_ext.build_extensions(self)
        File "/usr/lib/python3.10/distutils/command/build_ext.py", line 449, in build_extensions
          self._build_extensions_serial()
        File "/usr/lib/python3.10/distutils/command/build_ext.py", line 474, in _build_extensions_serial
          self.build_extension(ext)
        File "/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/setuptools/command/build_ext.py", line 202, in build_extension
          _build_ext.build_extension(self, ext)
        File "/usr/lib/python3.10/distutils/command/build_ext.py", line 529, in build_extension
          objects = self.compiler.compile(sources,
        File "/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/utils/cpp_extension.py", line 683, in unix_wrap_ninja_compile
          _write_ninja_file_and_compile_objects(
        File "/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/utils/cpp_extension.py", line 1783, in _write_ninja_file_and_compile_objects
          _run_ninja_build(
        File "/lambda/nfs/lambda-cloud-data/Align-Mamba/venv/lib/python3.10/site-packages/torch/utils/cpp_extension.py", line 2123, in _run_ninja_build
          raise RuntimeError(message) from e
      RuntimeError: Error compiling objects for extension
      [end of output]
  
  note: This error originates from a subprocess, and is likely not a problem with pip.
error: legacy-install-failure

× Encountered error while trying to install package.
╰─> flash-attn

note: This is an issue with the package mentioned above, not pip.
hint: See above for output from the failure.
