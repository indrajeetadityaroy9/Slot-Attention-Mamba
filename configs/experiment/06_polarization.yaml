# @package _global_
#
# Polarization Technique Ablation
#
# PURPOSE: Test polarized channels for recency bias mitigation
# - Standard Mamba: Learnable A matrix with exponential decay
# - Polarized: A=0 (local) + A=1 (cumsum) channels
#
# Reference: arXiv:2501.00658 (ICLR 2025)
# "Polarized Attention via Controlled A-eigenvalue Channels"
#
# USAGE:
#   python -m align_mamba.train experiment=06_polarization model.polarized_channels=0
#   python -m align_mamba.train experiment=06_polarization model.polarized_channels=2
#
#   # Test on capacity overflow scenarios
#   python -m align_mamba.train -m experiment=06_polarization \
#       model.polarized_channels=0,2 data.num_pairs=64,128,192

defaults:
  - override /data: mqar
  - override /model: hybrid_small
  - override /training: experiment_fast

experiment_name: polarization_ablation

project:
  name: polarization-ablation
  output_dir: outputs/06_polarization

model:
  vocab_size: 8192
  d_model: 256
  encoder_layers: 2
  decoder_layers: 4
  d_state: 64
  n_heads: 8
  hybrid_positions: [0]
  polarized_channels: 2

data:
  num_pairs: 128
  num_queries: 16
